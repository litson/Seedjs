<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <title>Seed test bed.</title>
    <style data-src="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css"></style>
    <style>
        body {
            font-family: "Microsoft yahei", Verdana, Arial, Helvetica, sans-serif;
        }

        .container {
            margin-top: 50px;
        }

        .input {
            position: fixed;
            width: 40%;
            right: 0;
            overflow: hidden;
            display: block;

            border-left: 1px solid #000;
            padding: 1rem;

            background-color: #eee;
        }

        .input textarea {
            border: none;
            outline: none;
            display: block;
            background-color: transparent;
            width: 100%;
            min-height: 800px;
            padding-bottom: 10rem;
        }
    </style>
</head>
<body>

<div class="container">

    <div id="preview" class="pull-left" style="width: 60%;min-height: 500px;margin-right: 1rem"></div>

    <div class="input">
        <textarea id="input" cols="30" rows="10"></textarea>
    </div>

</div>


<script data-src="//cdn.bootcss.com/jquery/3.0.0-beta1/jquery.min.js"></script>
<script data-src="//cdn.bootcss.com/markdown.js/0.5.0/markdown.min.js"></script>
<textarea class="hide" id="documents">
# Seedjs

可以将您的 `js` 、 `css` 文件在 `localStorage` 中管理。

## 全局配置

### data.delimiter

- 类型： `String`
- 默认值： `"seed"`
- 用法：

    ```js
        Seed.data.delimiter = 'src';
    ```

    修改 dom 查找的界定符。

### data.debug

- 类型： `Boolean`
- 默认值： `false`
- 用法：

    ```js
        Seed.data.debug = true;
    ```

    实时获取文件，并且文件不会存储到 `localStorage`中。


### data.base

- 类型： `String`
- 默认值： `window.location.origin`
- 用法：

   ```js
     Seed.data.base = 'http://localhost:63342/GITHUB/Seedjs'
   ```

  文件路径查找的前缀。

  注意：文件路径本身为绝对路径的话，不受 `base` 限制


### data.jsonp

- 类型： `String`
- 默认值： `null`
- 用法：

    ```js
        Seed.data.jsonp = '_seedJsonp_';
    ```

    `Seedjs` 拉取文件的方式为 `xhr` 拉取，但是需要对应的静态服务器开启 `CORS`。

    也提供了 `jsonp` 的方式，将我们的文件文本返回前端执行。

### data.map

- 类型： `String`
- 默认值： `null`
- 用法：

    ```js
        // defaultConfig 为 Seedjs 为您分析好的返回值，可供参考，或再无需分析的时候可直接返回他
        Seed.data.map = function ( url, defaultConfig ) {
            // 根据 url 分析出如下数据结构

            return {
                id     : '将会被存储的id',
                hook   : '是否应该更新的标记',
                fileUrl: '原始路径'
            }

            // 如果拿不定主意，或者有些许资源无需分析，可以返回 defaultConfig
            return defaultConfig;
        }
    ```

    该配置可对文件路径进行映射修改，可用于路径转换、在线调试等。

## API

### Seed.setItem( key, dataString )

- 参数：
    - `{String} key`
    - `{String} dataString`
- 用法：

    对 `localStorage.setItem` 的封装。

    内部做了是否支持 `localStorage` 的检测。

    ```js

        Seed.setItem( 'documents', '一些数据' );

    ```

### Seed.getItem( key )

- 参数：
    - `{String} key`
- 返回值：`key` 对应的 `localStorage` 数据。
- 用法：

    根据 `key` 来获取本地存储的数据。

    内部做了是否支持 `localStorage` 的检测。

    ```js

        Seed.getItem( 'documents' );

    ```

### Seed.removeItem( key )

- 参数：
    - `{String} key`
- 用法：

    对 `localStorage.setItem` 的封装，无参调用，会清除所有的 `localStorage`。

    内部做了是否支持 `localStorage` 的检测。

    ```js

        Seed.getItem( 'documents' );

    ```
</textarea>
<script src="../dist/seed.js"></script>
<script>
    /* global markdown */

    Seed.data.debug = true;
    Seed.data.delimiter = 'src';
    Seed.data.map = function ( url ) {
        var datas  = url.match( /^(.*\/)(.*)$/i );
        var result = {
            id     : datas[2],
            fileUrl: url,
            hook   : datas[1]
        };
        console.log(
                // 版本号处于地址之间的情况，demo输入如下，已文件名为id，hook采用文件名之前的所有
                JSON.stringify(
                        result,
                        null,
                        4
                )
        );
        return result;
    };

    Seed.scan( function () {

        var $preview = $( '#preview' );
        var $input   = $( '#input' );

        $input.val(
                Seed.getItem( 'documents' ) || $( '#documents' ).html().trim()
        );

        $input.on( 'input', function () {
            var value = this.value;
            $preview.html(
                    markdown.toHTML( value )
            );
            Seed.setItem( 'documents', value );
        } ).trigger( 'input' );

    } );
</script>
</body>
</html>